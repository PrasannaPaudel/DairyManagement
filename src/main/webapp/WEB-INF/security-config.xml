<beans:beans xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.springframework.org/schema/security"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security.xsd">

       <http auto-config="true">
              <access-denied-handler error-page="/error"/>
              <intercept-url pattern="/dairyAdmin**" access="ROLE_CHURCHADMIN"/>
              <intercept-url pattern="/dairyWorker**" access="ROLE_SCHOOLADMIN"/>
              <intercept-url pattern="/user**" access="ROLE_USER"/>
              <form-login login-page='/mainLogin'
                          username-parameter="staffUsername"
                          password-parameter="staffPassword"
                          default-target-url="/default"
                          authentication-failure-url="/mainLogin?authfailed"/>
              <logout logout-success-url="/mainLogin?logout"/>
       </http>

       <authentication-manager>
              <authentication-provider>
                     <jdbc-user-service data-source-ref="dataSource"
                                        users-by-username-query="select staffUsername,staffPassword,staffRetired from Staff where staffUsername =?"
                                        authorities-by-username-query="select staffUsername,ROLE from userRoles where staffUsername =?"/>
              </authentication-provider>
       </authentication-manager>

</beans:beans>






